# История изменений

## v0.2.0 - Модернизация UX (12.02.2026)

### Критические улучшения

**Conversational-First подход:**
- Убраны inline кнопки из /start команды
- Добавлены примеры вопросов в приветствии
- Пользователь сразу понимает что нужно писать текстом
- Кнопки доступны через команду /menu

**Оптимизация производительности:**
- Inline клавиатуры переведены на 2 колонки (~600ms вместо 1200ms)
- Короткий callback_data (экономия 35% bytes)
- Маппинг: `srv` вместо `services`, `cnt` вместо `contacts`, и т.д.

### Новые функции

**Quick Reply кнопки (ReplyKeyboardMarkup):**
- Контекстные кнопки под каждым ответом
- Адаптируются к намерению пользователя
- Не блокируют текстовый ввод
- Быстрее чем inline кнопки

**Определение намерений:**
- Автоматическое распознавание: pricing, services, contacts, order
- Контекстные quick replies на основе намерения
- Умные подсказки в зависимости от вопроса

**Visual feedback:**
- Typing indicators ("печатает...")
- Сообщение "Анализирую вопрос..." для длинных запросов
- Удаление промежуточных сообщений после ответа

**Прогрессивный онбординг:**
- Подсказки появляются после 1, 3, 5, 10, 20 сообщений
- Обучают пользователя возможностям бота
- Не навязчивые, появляются органично

**Улучшенная обработка ошибок:**
- Информативные сообщения при timeout Ollama
- Graceful fallback на поиск по FAQ
- Понятные объяснения что пошло не так

### Улучшения поиска

**Более строгий поиск по FAQ:**
- Минимальный порог релевантности 0.4
- Фильтрация стоп-слов (как, что, мне, и т.д.)
- Учет только значимых слов (>3 символов)
- Более точное сопоставление

**Улучшенное сообщение "не найдено":**
- Объясняет специализацию бота
- Показывает что бот может рассказать
- Предлагает контакты менеджера

### Новые команды

- `/menu` - показать навигационное меню (inline кнопки)
- Улучшен `/help` - более понятные инструкции
- Добавлен callback для статистики в меню

### Изменения в коде

**Новые файлы:**
- `src/utils/intent_detection.py` - определение намерений
- `src/utils/onboarding.py` - система подсказок
- `CHANGELOG.md` - этот файл

**Измененные файлы:**
- `src/bot/handlers/start.py` - новый welcome flow, команда /menu
- `src/bot/handlers/chat.py` - контекстные кнопки, visual feedback
- `src/bot/keyboards.py` - оптимизация, quick replies
- `src/bot/handlers/menu.py` - новые короткие callbacks
- `src/knowledge/search.py` - более строгий поиск
- `data/faq.json` - улучшенное сообщение not_found

---

## v0.1.0 - Первая версия (12.02.2026)

- Базовый функционал Telegram бота
- Интеграция с Ollama для AI ответов
- Поиск по FAQ (fallback режим)
- SQLite база для контекста диалогов
- Inline меню навигации
- Команды /start, /help, /reset, /stats
